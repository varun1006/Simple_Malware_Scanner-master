import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.security.NoSuchAlgorithmException;
import java.sql.Connection;

	public class ReadFile extends GFG 
	{
		 String name = null;
		 public Connection db_connection()
		 {
	   
	    	ConnectionDB connection = new ConnectionDB();
		    	
			Connection con = null ;
			
			                         
			con = connection.ConnectDB();
			return con;
	}
    public void read(String dirname)
    {	
    	ConnectionDB connection = new ConnectionDB();
    	Connection con=null;
    	con = connection.ConnectDB();
    	Database db = new Database();
    	String name = null;
    	
    	File f1 = new File(dirname);
    	if(f1.isFile())
    	{
    		Path filepath =  Paths.get(dirname);
    		try
			  
	        {
	            // reading file from given path
	           
	           String content = Files.readString(filepath);
	           name=content;
	          
	        }
	        
	        catch (IOException e) 
	        {
	            e.printStackTrace();
	        }
	        
	        try
			{
	        	String fpath = filepath.toString();
				db.search(toHexString(getSHA(name)),con,fpath);
			}
			// For specifying wrong message digest algorithms
			catch (NoSuchAlgorithmException e) 
	        {
				System.out.println("Exception thrown for incorrect algorithm: " + e);
			}
    	}
    	
    	
    else if(f1.isDirectory())
    	{
	    	    String s[] = f1.list();
	    	
				for(int i=0; i < s.length; i++)
		    	{
					File f = new File(dirname + "\\" + s[i]);
					if(f.isDirectory())
					{
						read( dirname+"\\"+s[i]);
					}
					else {
		    		Path filepath =  Paths.get(dirname + "\\" + s[i]);
			        try
			  
			        {
			            // reading file from given path
			           
			           String content = Files.readString(filepath);
			           name=content;
			          
			        }
			        
			        catch (IOException e) 
			        {
			            e.printStackTrace();
			        }
			        
			        try
					{
			        	String fpath = filepath.toString();
						db.search(toHexString(getSHA(name)),con,fpath);
					}
					// For specifying wrong message digest algorithms 
					catch (NoSuchAlgorithmException e) 
			        {
						System.out.println("Exception thrown for incorrect algorithm: " + e);
					}
		    	}
		    	}
	    	}
    	else
    		System.out.println("No such directory");
     
    }
}